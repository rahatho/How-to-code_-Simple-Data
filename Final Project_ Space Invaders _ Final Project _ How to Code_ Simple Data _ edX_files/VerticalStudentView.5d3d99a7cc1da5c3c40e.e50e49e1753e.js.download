(()=>{var e={35671:(e,t,n)=>{"use strict";function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,a(i.key),i)}}function s(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==i(t)?t:t+""}function l(e,t){var n=0;return function(){var i=Date.now();n+t<i&&(n=i,e())}}n.d(t,{markBlocksCompletedOnViewIfNeeded:()=>m});var u=function(){return s((function e(t,n,i){r(this,e),this.el=t,this.viewedAfterMs=n,this.callback=i,this.topSeen=!1,this.bottomSeen=!1,this.seenForMs=0,this.becameVisibleAt=void 0,this.hasBeenViewed=!1}),[{key:"getBoundingRect",value:function(){return this.el.getBoundingClientRect()}},{key:"handleVisible",value:function(){var e=this;this.becameVisibleAt||(this.becameVisibleAt=Date.now(),setTimeout((function(){e.checkIfViewed()}),this.viewedAfterMs-this.seenForMs))}},{key:"handleNotVisible",value:function(){this.becameVisibleAt&&(this.seenForMs=Date.now()-this.becameVisibleAt),this.becameVisibleAt=void 0}},{key:"markTopSeen",value:function(){this.topSeen=!0,this.checkIfViewed()}},{key:"markBottomSeen",value:function(){this.bottomSeen=!0,this.checkIfViewed()}},{key:"getTotalTimeSeen",value:function(){return this.becameVisibleAt?this.seenForMs+(Date.now()-this.becameVisibleAt):this.seenForMs}},{key:"areViewedCriteriaMet",value:function(){return this.topSeen&&this.bottomSeen&&this.getTotalTimeSeen()>=this.viewedAfterMs}},{key:"checkIfViewed",value:function(){this.hasBeenViewed||this.areViewedCriteriaMet()&&(this.hasBeenViewed=!0,this.callback(this.el,{elementHasBeenViewed:this.hasBeenViewed}))}}])}(),d=function(){return s((function e(){r(this,e),this.elementViewings=new Set,this.handlers=[],window===window.parent?this.registerDomHandlers():window.addEventListener("message",this.handleVisibilityMessage.bind(this))}),[{key:"addElement",value:function(e,t){var n=this;this.elementViewings.add(new u(e,t,(function(e,t){return n.callHandlers(e,t)}))),window===window.parent&&this.updateVisible()}},{key:"addHandler",value:function(e){this.handlers.push(e)}},{key:"updateVisible",value:function(){this.elementViewings.forEach((function(e){if(!e.hasBeenViewed){var t=Date.now(),n=e.getBoundingRect(),i=!1;n.top>0&&n.top<window.innerHeight&&(e.markTopSeen(t),i=!0),n.bottom>0&&n.bottom<window.innerHeight&&(e.markBottomSeen(t),i=!0),n.top<0&&n.bottom>window.innerHeight&&(i=!0),i?e.handleVisible(t):e.handleNotVisible(t)}}))}},{key:"registerDomHandlers",value:function(){var e=this;window.onscroll=l((function(){return e.updateVisible()}),100),window.onresize=l((function(){return e.updateVisible()}),100),this.updateVisible()}},{key:"callHandlers",value:function(e,t){this.handlers.forEach((function(n){n(e,t)}))}},{key:"handleVisibilityMessage",value:function(e){if("unit.visibilityStatus"===e.data.type){var t=e.data.data,n=t.topPosition,i=t.viewportHeight;this.elementViewings.forEach((function(e){var t=e.getBoundingRect(),r=!1,o=t.top+n,s=t.bottom+n;o<i&&o>=0&&(e.markTopSeen(),r=!0),s<=i&&s>0&&(e.markBottomSeen(),r=!0),r?e.handleVisible():e.handleNotVisible()}))}}}])}(),c=n(20428),h=new Set;function m(e,t){var n=c(t).find(".xblock-student_view[data-mark-completed-on-view-after-delay]").get();if(n.length>0){var i=new d;n.forEach((function(e){var t=parseInt(e.dataset.markCompletedOnViewAfterDelay,10);t>=0&&i.addElement(e,t)})),i.addHandler((function(t,n){var i=t.dataset.usageId;i&&!h.has(i)&&n.elementHasBeenViewed&&c.ajax({type:"POST",url:e.handlerUrl(t,"publish_completion"),data:JSON.stringify({completion:1})}).then((function(){h.add(i),t.dataset.markCompletedOnViewAfterDelay=0}))}))}}},78088:function(e,t,n){var i,r;(function(o){"use strict";i=[n(95891),n(20428),n(36220)],r=function(e,t,n){var i,r,o,s,a,l,u,d;function c(e){this.text=e}return c.prototype.valueOf=function(){return this.text},c.prototype.toString=function(){return this.text},o=function(t,i){var o=n.interpolate(r(t).toString(),e.mapObject(i,r));return a(o)},s=function(){var e,t="",n=arguments.length;for(e=0;e<n;e+=1)t+=r(arguments[e]);return a(t)},l=function(t,r){return function(o){var s=e.extend({HtmlUtils:i,StringUtils:n},o||{});return a(e.template(t,r)(s))}},u=function(e,n){return t(e).html(r(n).toString())},d=function(e,n){return t(e).prepend(r(n).toString())},i={append:function(e,n){return t(e).append(r(n).toString())},ensureHtml:r=function(t){return t instanceof c?t:a(e.escape(t))},HTML:a=function(e){return new c(e)},HtmlSnippet:c,interpolateHtml:o,joinHtml:s,prepend:d,setHtml:u,template:l}}.apply(t,i),void 0===r||(e.exports=r)}).call(this,n.amdD)},36220:function(e,t,n){var i;(function(n){"use strict";void 0===(i=function(){return{interpolate:function(e,t){return e.replace(/{\w+}/g,(function(e){var n=e.slice(1,-1);return String(t[n])}))}}}.apply(t,[]))||(e.exports=i)}).call(this,n.amdD)},41028:e=>{e.exports='<div class="banner-msg wrapper-msg urgency-<%- urgency %> <%- type %> <% if (isRecoveryEmailMsg == true) { %> recovery-email-alert <% } %> <% if (isLearnerPortalEnabled == true) { %> learner-portal-enabled-alert <% } %>" role="alert">\n  <i <% if (hideCloseBtn == true) { %> hidden <% } %> class="fa fa-close close-icon close-btn"></i>\n    <div class="msg">\n        <div class="msg-content">\n            <div class="copy">\n                <p><%= HtmlUtils.HTML(message) %></p>\n            </div>\n        </div>\n    </div>\n</div>\n'},76063:(e,t,n)=>{"use strict";var i,r;i=[n(90165),n(20428),n(95891),n(99927),n(41028),n(78088)],void 0===(r=function(e,t,n,i,r,o){return i.View.extend({events:{"click .close-btn":"closeBanner"},closeBanner:function(e){sessionStorage.setItem("isBannerClosed",!0),this.hideMessage()},initialize:function(e){n.isUndefined(e)&&(e={}),this.options=n.defaults(e,{urgency:"high",type:"",hideCloseBtn:!0,isRecoveryEmailMsg:!1,isLearnerPortalEnabled:!1})},render:function(){return n.isUndefined(this.message)||n.isNull(this.message)?this.$el.html(""):this.$el.html(n.template(r)(n.extend(this.options,{message:this.message,HtmlUtils:o}))),this},showMessage:function(e){this.message=e,null==sessionStorage.getItem("isBannerClosed")&&this.render()},hideMessage:function(){this.message=null,this.render()}})}.apply(t,i))||(e.exports=r)},69371:(e,t,n)=>{"use strict";var i,r;i=[n(90165),n(20428),n(95891),n(99927),n(76063)],void 0===(r=function(e,t,n,i,r){return i.View.extend({errorMessage:e("An error has occurred. Please try again."),bookmarkText:e("Bookmark this page"),bookmarkedText:e("Bookmarked"),events:{click:"toggleBookmark"},showBannerInterval:5e3,initialize:function(e){this.apiUrl=e.apiUrl,this.bookmarkId=e.bookmarkId,this.bookmarked=e.bookmarked,this.usageId=e.usageId,e.bookmarkedText&&(this.bookmarkedText=e.bookmarkedText),e.bookmarkText&&(this.bookmarkText=e.bookmarkText),this.setBookmarkState(this.bookmarked)},toggleBookmark:function(e){e.preventDefault(),this.$el.prop("disabled",!0),this.$el.hasClass("bookmarked")?this.removeBookmark():this.addBookmark()},addBookmark:function(){var e=this;t.ajax({data:{usage_id:e.usageId},type:"POST",url:e.apiUrl,dataType:"json",success:function(){e.$el.trigger("bookmark:add"),e.setBookmarkState(!0)},error:function(t){var n,i;try{i=(n=t.responseText?JSON.parse(t.responseText):"")?n.user_message:"",e.showError(i)}catch(t){e.showError()}},complete:function(){e.$el.prop("disabled",!1),e.$el.focus()}})},removeBookmark:function(){var e=this,n=e.apiUrl+e.bookmarkId+"/";t.ajax({type:"DELETE",url:n,success:function(){e.$el.trigger("bookmark:remove"),e.setBookmarkState(!1)},error:function(){e.showError()},complete:function(){e.$el.prop("disabled",!1),e.$el.focus()}})},setBookmarkState:function(e){e?(this.$el.addClass("bookmarked"),this.$el.attr("aria-pressed","true"),this.$el.find(".bookmark-text").text(this.bookmarkedText)):(this.$el.removeClass("bookmarked"),this.$el.attr("aria-pressed","false"),this.$el.find(".bookmark-text").text(this.bookmarkText))},showError:function(e){var i=e||this.errorMessage;this.messageView||(this.messageView=new r({el:t(".message-banner"),type:"error"})),this.messageView.showMessage(i),setTimeout(n.bind((function(){this.messageView.hideMessage()}),this),this.showBannerInterval)}})}.apply(t,i))||(e.exports=r)},99927:e=>{"use strict";e.exports=window.Backbone},95891:e=>{"use strict";e.exports=window._},90165:e=>{"use strict";e.exports=window.gettext},20428:e=>{"use strict";e.exports=window.jQuery}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,n),o.exports}n.amdD=function(){throw new Error("define cannot be used indirect")},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};(()=>{"use strict";n.r(i);var e=n(69371),t=n.n(e),r=n(35671),o=n(20428);new Set;window.VerticalStudentView=function(e,n){var i=o(n),s=i.find(".bookmark-button");return(0,r.markBlocksCompletedOnViewIfNeeded)(e,n),new(t())({el:s,bookmarkId:s.data("bookmarkId"),usageId:i.data("usageId"),bookmarked:i.parent("#seq_content").data("bookmarked"),apiUrl:s.data("bookmarksApiUrl")})}})();var r=window;for(var o in i)r[o]=i[o];i.__esModule&&Object.defineProperty(r,"__esModule",{value:!0})})();